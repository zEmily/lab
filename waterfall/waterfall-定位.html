<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>瀑布流定位</title>
    <link href="css/style.css" rel="stylesheet" type="text/css" />

</head>
<body>
<div id="wrap" class="wrap active">

    <div class='mode'><p class='pic'><a href='#'><img src=images/aDLpYnNtt.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>aDLpYnNtt.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/aF+fqDXvRTOQnqr.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>aF+fqDXvRTOQnqr.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ayOgMwzyswmQnq.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ayOgMwzyswmQnq.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/AVxvpyFfTtpdqoq.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>AVxvpyFfTtpdqoq.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/RuLvRqlCkyGQnqrJvX.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>RuLvRqlCkyGQnqrJvX.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ecuedxGXc.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ecuedxGXc.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ByUiHEFhHSq.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ByUiHEFhHSq.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/sqktLdYoum.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>sqktLdYoum.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/zuXPkkUCzhFdqoqQ.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>zuXPkkUCzhFdqoqQ.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/AnsHwRExTBeQ.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>AnsHwRExTBeQ.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/jyyFICWtcIKQnqrJvXNW.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>jyyFICWtcIKQnqrJvXNW.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/XoCXcuedzzqqtSQnqrJ.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>XoCXcuedzzqqtSQnqrJ.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ysuftSKC++t.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ysuftSKC++t.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/jAuiVZ.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>jAuiVZ.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/oBpZvKlqu.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>oBpZvKlqu.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/pHUNEtxlz.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>pHUNEtxlz.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/uSwZRxVkuseQnqrJ.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>uSwZRxVkuseQnqrJ.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ayOgMwzyswmQnq.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ayOgMwzyswmQnq.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/YWyXpRIvNmxdqo.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>YWyXpRIvNmxdqo.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/gTYhRyFcuedvaddqo.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>gTYhRyFcuedvaddqo.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/gWBBxYzzFqK+FNAXXpp.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>gWBBxYzzFqK+FNAXXpp.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/beyssysbQQuQnqrJv.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>beyssysbQQuQnqrJv.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/jyyFICWtcIKQnqrJvXNW.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>jyyFICWtcIKQnqrJvXNW.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/lPmwdlb.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>lPmwdlb.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/RuLvRqlCkyGQnqrJvX.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>RuLvRqlCkyGQnqrJvX.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/catzzKQsvthdqoqQFfUT.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>catzzKQsvthdqoqQFfUT.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/sqktLdYoum.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>sqktLdYoum.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/ysuftSKC++t.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>ysuftSKC++t.jpg</a></span></h3></div><div class='mode'><p class='pic'><a href='#'><img src=images/zYkYyhlBKj+Qnq.jpg style='height:auto';'/></a></p><h3 class='tit'><span><a href='#'>zYkYyhlBKj+Qnq.jpg</a></span></h3></div></div>
</body>
<script type="text/javascript">
    var $id = function(o){ return document.getElementById(o) || o};
    var warpWidth = 220; //格子宽度
    var margin = 14; //格子间距
    function sort(el,childTagName){
        var h = []; //记录每列的高度
        var box = el.getElementsByTagName(childTagName);
        var minH = box[0].offsetHeight,
                boxW = box[0].offsetWidth+margin;
        n = document.documentElement.offsetWidth / boxW | 0; //计算页面能排下多少Pin
        el.style.width = n * boxW - margin + "px";
        el.style.visibility = "visible";
        for(var i = 0; i < box.length; i++) {//排序算法，有待完善
            boxh = box[i].offsetHeight; //获取每个Pin的高度
            if(i < n) { //第一行特殊处理
                h[i] = boxh;
                box[i].style.top = 0 + 'px';
                box[i].style.left = (i * boxW) + 'px';
            }
            else {
                minH = Array.min(h); //取得各列累计高度最低的一列
                minKey = getarraykey(h, minH);
                h[minKey] += boxh+margin ; //加上新高度后更新高度值
                box[i].style.top = minH+margin + 'px';
                box[i].style.left = (minKey * boxW) + 'px';
            }
            maxH = Array.max(h);
            maxKey = getarraykey(h, maxH);
            el.style.height = h[maxKey] +"px";//定位结束后更新容器高度
        }
        for(var i = 0; i < box.length; i++) {
            box[i].style.visibility = "visible"; //定位完毕后显示节点
        }
    }
    Array.min=function(array)
    {
        return Math.min.apply(Math,array);
    }
    Array.max=function(array)
    {
        return Math.max.apply(Math,array);
    }
    /* 返回数组中某一值的对应项数 */
    function getarraykey(s, v) {
        for(k in s) {
            if(s[k] == v) {
                return k;
            }
        }
    }

    window.onload = function() {
        sort($id("wrap"),"div");
    };

    var re;
    window.onresize = function() {
        clearTimeout(re);
        re = setTimeout(resize,100);
    };

    function resize(){
        $id("wrap").className = "wrap active";
        sort($id("wrap"),"div");
    }

</script>
<div id="aaa1" style="display:none;position: fixed;width:400px;height:200px;background:#000;color:#fff;top:30%;left:50%"></div>
</html>